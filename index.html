<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Instagram - Share photos and connect with friends">
    <title>Instagram</title>
    <link rel="stylesheet" href="index.css">
    <link rel="icon" href="https://static.cdninstagram.com/rsrc.php/y4/r/QaBlI0OZiks.ico" type="image/x-icon">
</head>

<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <!-- Logo -->
            <a href="index.html">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Instagram_logo.svg/800px-Instagram_logo.svg.png"
                    alt="Instagram" class="navbar-logo">
            </a>

            <!-- Search -->
            <div class="navbar-search">
                <svg class="icon navbar-search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                </svg>
                <input type="text" class="navbar-search-input" placeholder="Search">
            </div>

            <!-- Navigation Icons -->
            <div class="navbar-nav">
                <!-- Home -->
                <a href="index.html" class="nav-icon active" title="Home">
                    <svg class="icon" viewBox="0 0 24 24" fill="currentColor" stroke="none">
                        <path
                            d="M9.005 16.545a2.997 2.997 0 0 1 2.997-2.997A2.997 2.997 0 0 1 15 16.545V22h7V11.543L12 2 2 11.543V22h7.005Z" />
                    </svg>
                </a>

                <!-- Messenger -->
                <a href="#" class="nav-icon" title="Messages">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M22 2 11 13" />
                        <path d="m22 2-7 20-4-9-9-4 20-7z" />
                    </svg>
                </a>

                <!-- New Post -->
                <a href="#" class="nav-icon" title="Create" id="createBtn">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                        <line x1="12" y1="8" x2="12" y2="16" />
                        <line x1="8" y1="12" x2="16" y2="12" />
                    </svg>
                </a>

                <!-- Explore -->
                <a href="#" class="nav-icon" title="Explore">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <circle cx="12" cy="12" r="10" />
                        <polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76" />
                    </svg>
                </a>

                <!-- Notifications -->
                <a href="#" class="nav-icon" title="Notifications">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path
                            d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" />
                    </svg>
                </a>

                <!-- Profile -->
                <a href="#" class="nav-icon" title="Profile">
                    <img src="https://i.pravatar.cc/150?img=3" alt="Profile" class="avatar avatar-sm"
                        style="border: 2px solid var(--ig-text-primary);">
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="feed-container">
            <!-- Story Tray -->
            <div class="card" style="padding: 16px; margin-bottom: 24px;">
                <div class="story-tray" id="storyTray">
                    <!-- Stories will be inserted by JavaScript -->
                </div>
            </div>

            <!-- Posts -->
            <div id="postsContainer">
                <!-- Posts will be inserted by JavaScript -->
            </div>
        </div>
    </main>

    <!-- Sidebar -->
    <aside class="sidebar">
        <!-- Current User -->
        <div class="sidebar-user">
            <img src="https://i.pravatar.cc/150?img=3" alt="Your profile" class="avatar avatar-xl">
            <div class="sidebar-user-info">
                <span class="sidebar-username">your_username</span>
                <span class="sidebar-fullname">Your Name</span>
            </div>
            <button class="logout-btn" id="logoutBtn" title="Logout">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                    <polyline points="16 17 21 12 16 7" />
                    <line x1="21" y1="12" x2="9" y2="12" />
                </svg>
            </button>
        </div>

        <!-- Suggestions -->
        <div class="sidebar-section">
            <div class="sidebar-header">
                <span class="sidebar-title">Suggested for you</span>
                <span class="sidebar-see-all">See All</span>
            </div>

            <div id="suggestionsContainer">
                <!-- Suggestions will be inserted by JavaScript -->
            </div>
        </div>

        <!-- Footer -->
        <div class="sidebar-footer">
            <p>
                <a href="#">About</a> ·
                <a href="#">Help</a> ·
                <a href="#">Press</a> ·
                <a href="#">API</a> ·
                <a href="#">Jobs</a> ·
                <a href="#">Privacy</a> ·
                <a href="#">Terms</a> ·
                <a href="#">Locations</a> ·
                <a href="#">Language</a>
            </p>
            <p style="margin-top: 16px;">© 2024 INSTAGRAM CLONE</p>
        </div>
    </aside>

    <!-- Mobile Bottom Navigation -->
    <nav class="mobile-nav">
        <a href="index.html" class="nav-icon active">
            <svg class="icon" viewBox="0 0 24 24" fill="currentColor" stroke="none">
                <path
                    d="M9.005 16.545a2.997 2.997 0 0 1 2.997-2.997A2.997 2.997 0 0 1 15 16.545V22h7V11.543L12 2 2 11.543V22h7.005Z" />
            </svg>
        </a>
        <a href="#" class="nav-icon">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
            </svg>
        </a>
        <a href="#" class="nav-icon">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                <line x1="12" y1="8" x2="12" y2="16" />
                <line x1="8" y1="12" x2="16" y2="12" />
            </svg>
        </a>
        <!-- Mobile Logout Button -->
        <a href="#" class="nav-icon mobile-logout-btn" id="mobileLogoutBtn" title="Logout">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                <polyline points="16 17 21 12 16 7" />
                <line x1="21" y1="12" x2="9" y2="12" />
            </svg>
        </a>
        <a href="#" class="nav-icon">
            <img src="https://i.pravatar.cc/150?img=3" alt="Profile" class="avatar avatar-sm">
        </a>
    </nav>

    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase.js"></script>
    <script src="app.js"></script>
    <script>
        // Check authentication on page load
        const user = SupabaseAuth.requireAuth();

        if (user) {
            // Update user info in sidebar
            const username = user.username || 'user';
            const fullName = user.full_name || 'Instagram User';
            const avatar = user.avatar_url || `https://i.pravatar.cc/150?u=${username}`;

            // Update profile picture in navbar
            const profileImgs = document.querySelectorAll('.nav-icon img.avatar, .mobile-nav img.avatar');
            profileImgs.forEach(img => {
                img.src = avatar;
            });

            // Update sidebar
            const sidebarAvatar = document.querySelector('.sidebar-user .avatar');
            const sidebarUsername = document.querySelector('.sidebar-username');
            const sidebarFullname = document.querySelector('.sidebar-fullname');

            if (sidebarAvatar) sidebarAvatar.src = avatar;
            if (sidebarUsername) sidebarUsername.textContent = username;
            if (sidebarFullname) sidebarFullname.textContent = fullName;
        }

        // Handle logout - Desktop sidebar button
        document.getElementById('logoutBtn')?.addEventListener('click', () => {
            SupabaseAuth.signOut();
        });

        // Handle logout - Mobile button
        document.getElementById('mobileLogoutBtn')?.addEventListener('click', (e) => {
            e.preventDefault();
            SupabaseAuth.signOut();
        });
    </script>

    <style>
        /* Logout button styles */
        .logout-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--ig-text-primary);
            transition: all 0.2s ease;
        }

        .logout-btn:hover {
            background-color: var(--ig-bg-secondary);
            color: #ed4956;
        }

        .mobile-logout-btn {
            color: var(--ig-text-primary);
        }

        .mobile-logout-btn:hover {
            color: #ed4956;
        }
    </style>
</body>

</html>